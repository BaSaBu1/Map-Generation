#| message: false
#| warning: false
#| include: false
# read in data
music <- read.csv("https://bcheggeseth.github.io/253_spring_2024/data/billboard.csv")
# Check out artists with at least 40 songs
music %>%
count(performer) %>%
filter(n >= 40) %>%
select(performer)
#| include: false
library(tidyverse)
library(tidymodels)
library(cluster)
library(factoextra)
library(reshape2)
#| message: false
#| warning: false
#| include: false
# read in data
music <- read.csv("https://bcheggeseth.github.io/253_spring_2024/data/billboard.csv")
# Check out artists with at least 40 songs
music %>%
count(performer) %>%
filter(n >= 40) %>%
select(performer)
# Pick just one of these artists to study
my_artist <- music %>%
select(-key, -billboard_weeks, -spotify_popularity) %>%
filter(performer == "The Weeknd") %>%
select(-performer) %>%
group_by(song) %>%       # The last rows deal w songs that appear more than once
slice_sample(n = 1) %>%
ungroup()
# clean data, if necessary
artist_data <- my_artist %>%
column_to_rownames("song")
#| include: false
hier_model <- hclust(dist(scale(artist_data)), method = "complete")
#| echo: false
fviz_dend(hier_model, horiz = TRUE, cex = .5)
#| echo: false
fviz_nbclust(scale(artist_data), kmeans, method='silhouette')
#| message: false
#| warning: false
#|
# Set a seed to ensure our analysis is reproducible
set.seed(253)
# Use hierarchical clustering first to visualize relationships and spot outliers
hier_model <- hclust(dist(scale(artist_data)), method = "complete")
# Dendrogram to visualize the tree structure and identify the outlier
fviz_dend(hier_model, horiz = TRUE, cex = .5)
# Check the average silhouette to see how well different K values group
fviz_nbclust(scale(artist_data), kmeans, method='silhouette')
# Calculate total within-cluster variance to compare the variance
tibble(K = 2:10) %>%
mutate(SS = map(K, ~ kmeans(scale(artist_data), centers = .x)$tot.withinss)) %>%
unnest(cols = c(SS))
# Choose K=2 for k-means clustering based on our analysis
kmeans_model <- kmeans(scale(artist_data), centers = 2)
# Add the cluster labels to the dataset for interpretation
cluster_kmeans <- artist_data %>%
mutate(kmeans_cluster_k = as.factor(kmeans_model$cluster))
#| echo: false
library(knitr)
cluster_kmeans %>%
select(danceability, energy, loudness, acousticness, valence, kmeans_cluster_k) %>%
group_by(kmeans_cluster_k) %>%
summarise_all(mean) %>%
kable(digits = 2,
col.names = c("Cluster", "Danceability", "Energy", "Loudness", "Acousticness", "Valence"),
caption = "Average Features by Cluster")
#| message: false
#| warning: false
#|
# Set a seed to ensure our analysis is reproducible
set.seed(253)
# Use hierarchical clustering first to visualize relationships and spot outliers
hier_model <- hclust(dist(scale(artist_data)), method = "complete")
# Dendrogram to visualize the tree structure and identify the outlier
fviz_dend(hier_model, horiz = TRUE, cex = .5)
# Check the average silhouette to see how well different K values group
fviz_nbclust(scale(artist_data), kmeans, method='silhouette')
# Calculate total within-cluster variance to compare the variance
tibble(K = 2:10) %>%
mutate(SS = map(K, ~ kmeans(scale(artist_data), centers = .x)$tot.withinss)) %>%
unnest(cols = c(SS))
# Choose K=2 for k-means clustering based on our analysis
set.seed(253)
kmeans_model <- kmeans(scale(artist_data), centers = 2)
# Add the cluster labels to the dataset for interpretation
cluster_kmeans <- artist_data %>%
mutate(kmeans_cluster_k = as.factor(kmeans_model$cluster))
#| echo: false
library(knitr)
cluster_kmeans %>%
select(danceability, energy, loudness, acousticness, valence, kmeans_cluster_k) %>%
group_by(kmeans_cluster_k) %>%
summarise_all(mean) %>%
kable(digits = 2,
col.names = c("Cluster", "Danceability", "Energy", "Loudness", "Acousticness", "Valence"),
caption = "Average Features by Cluster")
#| echo: false
# Mood Analysis (Valence vs Danceability)
cluster_kmeans %>%
ggplot(aes(x = valence, y = danceability, color = kmeans_cluster_k)) +
annotate("text", x = 0.8, y = 0.9, label = "Happy & Danceable", color = "gray60", size = 3, fontface = "italic") +
annotate("text", x = 0.1, y = 0.1, label = "Sad & Slow", color = "gray60", size = 3, fontface = "italic") +
geom_point(size = 3.5, alpha = 0.7) +
scale_color_manual(values = c("#4C6C88", "#FEDD0B"), name = "Cluster") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 14),
legend.position = "right", panel.grid.minor = element_blank()) +
labs(title = "Mood Analysis: Valence vs. Danceability", x = "Valence", y = "Danceability")
# Production Style (Energy vs Acousticness)
cluster_kmeans %>%
ggplot(aes(x = energy, y = acousticness, color = kmeans_cluster_k)) +
annotate("text", x = 0.85, y = 0.1, label = "Electronic/Pop", color = "gray60", size = 3, fontface = "italic") +
annotate("text", x = 0.35, y = 0.8, label = "Acoustic/R&B", color = "gray60", size = 3, fontface = "italic") +
geom_point(size = 3.5, alpha = 0.7) +
scale_color_manual(values = c("#4C6C88", "#FEDD0B"), name = "Cluster") +
theme_minimal() +
theme(plot.title = element_text(face = "bold", size = 14),
legend.position = "right", panel.grid.minor = element_blank()) +
labs(title = "Production Style: Energy vs. Acousticness",
x = "Energy",
y = "Acousticness")
#| message: false
#| warning: false
# scale = TRUE, center = TRUE first standardizes the features
pca_results <- prcomp(artist_data, scale = TRUE, center = TRUE)
#| message: false
#| warning: false
# scale = TRUE, center = TRUE first standardizes the features
pca_results <- prcomp(artist_data, scale = TRUE, center = TRUE)
#| echo: false
fviz_pca_var(pca_results, repel = TRUE)
#| echo: false
# Graphical summary 2: Plot cumulative % of variance explained by each PC
pca_results %>%
tidy(matrix = "eigenvalues") %>%
rbind(0) %>%
ggplot(aes(y = cumulative, x = PC)) +
geom_point(size = 2) +
geom_line() +
labs(y = "CUMULATIVE % of variance explained")
#| echo: false
# Graphical summary 2: Plot cumulative % of variance explained by each PC
pca_results %>%
tidy(matrix = "eigenvalues") %>%
rbind(0) %>%
ggplot(aes(y = cumulative, x = PC)) +
geom_point(size = 2) +
geom_line() +
labs(y = "CUMULATIVE % of variance explained")
#| echo: false
# Graphical summary: Score plot
# Plot PC1 scores (x-axis) vs PC2 scores (y-axis) of all data points
fviz_pca_ind(pca_results, repel = TRUE)
#| include: false
#| warning: false
library(tidyverse)
library(tidymodels)
library(cluster)
library(factoextra)
library(reshape2)
#| echo: false
# Graphical summary: Score plot
# Plot PC1 scores (x-axis) vs PC2 scores (y-axis) of all data points
fviz_pca_ind(pca_results, repel = TRUE)
#| echo: false
# Graphical summary: Score plot
# Plot PC1 scores (x-axis) vs PC2 scores (y-axis) of all data points
fviz_pca_ind(pca_results, repel = TRUE)
View(artist_data)
